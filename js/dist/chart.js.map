{"version":3,"sources":["../src/chart.js"],"names":["define","inst","AJAX_URL","UREA","PRILE","AMONIA","MELAMIN","SENSORS","join","g","labels","months","chart","chartData","ajax","callback","d","t","Date","num_rows","timestamp_start","setDate","getDate","timestamp_end","now","table_name","sensors","$","url","type","dataType","data","beforeSend","done","handleChartData","fail","list","rowList","labelArr","urea","prile","amonia","melamin","forEach","o","sensorId","timestamp","date","push","getMonth","value","console","log","datasets","label","toLowerCase","update","createChart","ctx","options","legend","display","position","usePointStyle","lineTension","fill","borderColor","Chart","init","window"],"mappings":";;AAAAA,OAAO,EAAP,EAAW,YAAY;AACtB,KAAIC,OAAO,EAAX;;AAEA,KAAMC,WAAW,kCAAjB;AACA,KAAMC,OAAO,EAAb;AACA,KAAMC,QAAQ,EAAd;AACA,KAAMC,SAAS,EAAf;AACA,KAAMC,UAAU,EAAhB;AACA,KAAMC,UAAU,CAAC,EAAD,EAAK,EAAL,EAAS,EAAT,EAAa,EAAb,EAAiBC,IAAjB,CAAsB,GAAtB,CAAhB;;AAEA,KAAIC,IAAI;AACPC,UAAQ,EADD;AAEPC,UAAQ,CAAC,SAAD,EAAY,UAAZ,EAAwB,OAAxB,EAAiC,OAAjC,EAA0C,KAA1C,EAAiD,MAAjD,EAAyD,MAAzD,EAAiE,QAAjE,EAA2E,WAA3E,EAAwF,SAAxF,EAAmG,UAAnG,EAA+G,UAA/G,CAFD;AAGPC,SAAO,EAHA;AAIPC,aAAW;;AAEX;AANO,EAAR;;AASA,UAASC,IAAT,CAAcC,QAAd,EAAwB;AACvB,MAAIC,IAAI,EAAR;AACA,MAAIC,IAAI,IAAIC,IAAJ,EAAR;;AAEAF,IAAEG,QAAF,GAAa,CAAb;AACAH,IAAEI,eAAF,GAAoBH,EAAEI,OAAF,CAAWJ,EAAEK,OAAF,KAAc,CAAzB,CAApB;AACAN,IAAEO,aAAF,GAAkBL,KAAKM,GAAL,EAAlB;AACAR,IAAES,UAAF,GAAe,cAAf;AACAT,IAAEU,OAAF,GAAYnB,OAAZ;;AAEAoB,IAAEb,IAAF,CAAO;AACNc,QAAK1B,QADC;AAEN2B,SAAM,KAFA;AAGNC,aAAU,MAHJ;AAINC,SAAMf,CAJA;AAKNgB,eAAY,sBAAY,CAAE;AALpB,GAAP,EAOCC,IAPD,CAOOC,eAPP,EAQCC,IARD;AASA;AACD,UAASD,eAAT,CAAyBlB,CAAzB,EAA4B;AAC3B,MAAIoB,OAAOpB,EAAEqB,OAAb;AACA,MAAIC,WAAW,EAAf;AACA,MAAIP,OAAO;AACVQ,SAAM,EADI;AAEVC,UAAO,EAFG;AAGVC,WAAQ,EAHE;AAIVC,YAAS;AAJC,GAAX;;AAOAN,OAAKO,OAAL,CAAa,UAAUC,CAAV,EAAa;AACzB,OAAIA,EAAEC,QAAF,KAAe1C,IAAnB,EAAyB;AACxB,QAAI2C,YAAYF,EAAEE,SAAlB;AACA,QAAIC,OAAO,IAAI7B,IAAJ,CAAS4B,SAAT,CAAX;AACAR,aAASU,IAAT,CAAevC,EAAEE,MAAF,CAAUoC,KAAKE,QAAL,EAAV,IAA6B,GAA7B,GAAkCF,KAAKzB,OAAL,EAAjD;;AAEAS,SAAKQ,IAAL,CAAUS,IAAV,CAAeJ,EAAEM,KAAjB;AACA,IAND,MAMO,IAAIN,EAAEC,QAAF,KAAezC,KAAnB,EAA0B;AAChC2B,SAAKS,KAAL,CAAWQ,IAAX,CAAgBJ,EAAEM,KAAlB;AACA,IAFM,MAEA,IAAIN,EAAEC,QAAF,KAAexC,MAAnB,EAA2B;AACjC0B,SAAKU,MAAL,CAAYO,IAAZ,CAAiBJ,EAAEM,KAAnB;AACA,IAFM,MAEA,IAAIN,EAAEC,QAAF,KAAevC,OAAnB,EAA4B;AAClCyB,SAAKW,OAAL,CAAaM,IAAb,CAAkBJ,EAAEM,KAApB;AACA;AACD,GAdD;AAeAC,UAAQC,GAAR,CAAYd,QAAZ;AACA7B,IAAEG,KAAF,CAAQmB,IAAR,CAAarB,MAAb,GAAsB4B,QAAtB;AACA7B,IAAEG,KAAF,CAAQmB,IAAR,CAAasB,QAAb,CAAsBV,OAAtB,CAA8B,UAAUC,CAAV,EAAa;;AAE1CA,KAAEb,IAAF,GAASA,KAAMa,EAAEU,KAAF,CAAQC,WAAR,EAAN,CAAT;AACA,GAHD;AAIA9C,IAAEG,KAAF,CAAQ4C,MAAR;AACA;;AAED,UAASC,WAAT,GAAuB;AACtB,MAAIC,MAAM/B,EAAE,UAAF,CAAV,CADsB,CACI;;AAE1B,MAAIgC,UAAU;AACbC,WAAQ;AACPC,aAAS,IADF;AAEPC,cAAU,OAFH;AAGPR,WAAO;AACNS,oBAAe;AADT;AAHA;AADK,GAAd;AASA,MAAIhC,OAAO;AACVrB,WAAQ,EADE;AAEV2C,aAAU,CAAC;AACVC,WAAO,MADG;AAEVU,iBAAa,CAFH;AAGZ;AACEC,UAAM,KAJI;AAKVC,iBAAa;AALH,IAAD,EAMP;AACFZ,WAAO,OADL;AAEFU,iBAAa,CAFX;AAGJ;AACEC,UAAM,KAJJ;AAKFC,iBAAa;AALX,IANO,EAYP;AACFZ,WAAO,QADL;AAEFU,iBAAa,CAFX;AAGJ;AACEC,UAAM,KAJJ;AAKFC,iBAAa;AALX,IAZO,EAkBP;AACFZ,WAAO,SADL;AAEFU,iBAAa,CAFX;AAGJ;AACEC,UAAM,KAJJ;AAKFC,iBAAa;AALX,IAlBO;AAFA,GAAX;AA4BAzD,IAAEG,KAAF,GAAU,IAAIuD,KAAJ,CAAUT,GAAV,EAAe;AACxB7B,SAAM,MADkB;AAExBE,SAAMA,IAFkB;AAGxB4B,YAASA;AAHe,GAAf,CAAV;AAKA;AACD,UAASS,IAAT,GAAgB;AACftD;AACA2C;AACA;;AAEDxD,MAAKmE,IAAL,GAAYA,IAAZ;;AAEAC,QAAOzD,KAAP,GAAeH,CAAf;AACA,QAAOR,IAAP;AACA,CAhID;;AAmIA","file":"chart.js","sourcesContent":["define([], function () {\r\n\tlet inst = {};\r\n\t\r\n\tconst AJAX_URL = \"http://127.0.0.1:1081/khp/report\";\r\n\tconst UREA = 12;\r\n\tconst PRILE = 13;\r\n\tconst AMONIA = 14;\r\n\tconst MELAMIN = 15;\r\n\tconst SENSORS = [12, 13, 14, 15].join(\",\");\r\n\t\r\n\tlet g = {\r\n\t\tlabels: [],\r\n\t\tmonths: [\"January\", \"February\", \"March\", \"April\", \"May\", \"June\", \"July\", \"August\", \"September\", \"October\", \"November\", \"December\"],\r\n\t\tchart: {},\r\n\t\tchartData: {}\r\n\t\t\r\n\t\t// \"rgba(75, 192, 192, 0.4)\"\r\n\t};\r\n\t\r\n\tfunction ajax(callback) {\r\n\t\tlet d = {};\r\n\t\tlet t = new Date();\r\n\t\t\r\n\t\td.num_rows = 7;\r\n\t\td.timestamp_start = t.setDate( t.getDate() - 7 ) ;\r\n\t\td.timestamp_end = Date.now();\r\n\t\td.table_name = \"report_1_day\";\r\n\t\td.sensors = SENSORS;\r\n\t\t\r\n\t\t$.ajax({\r\n\t\t\turl: AJAX_URL,\r\n\t\t\ttype: \"GET\",\r\n\t\t\tdataType: \"json\",\r\n\t\t\tdata: d,\r\n\t\t\tbeforeSend: function () {}\r\n\t\t})\r\n\t\t.done( handleChartData )\r\n\t\t.fail(  );\r\n\t}\r\n\tfunction handleChartData(d) {\r\n\t\tlet list = d.rowList;\r\n\t\tlet labelArr = [];\r\n\t\tlet data = {\r\n\t\t\turea: [],\r\n\t\t\tprile: [],\r\n\t\t\tamonia: [],\r\n\t\t\tmelamin: []\r\n\t\t};\r\n\t\t\r\n\t\tlist.forEach(function (o) {\r\n\t\t\tif (o.sensorId === UREA) {\r\n\t\t\t\tlet timestamp = o.timestamp;\r\n\t\t\t\tlet date = new Date(timestamp);\r\n\t\t\t\tlabelArr.push( g.months[ date.getMonth() ] +\"-\"+ date.getDate() );\r\n\t\t\t\t\r\n\t\t\t\tdata.urea.push(o.value);\r\n\t\t\t} else if (o.sensorId === PRILE) {\r\n\t\t\t\tdata.prile.push(o.value);\r\n\t\t\t} else if (o.sensorId === AMONIA) {\r\n\t\t\t\tdata.amonia.push(o.value);\r\n\t\t\t} else if (o.sensorId === MELAMIN) {\r\n\t\t\t\tdata.melamin.push(o.value);\r\n\t\t\t}\r\n\t\t});\r\n\t\tconsole.log(labelArr);\r\n\t\tg.chart.data.labels = labelArr;\r\n\t\tg.chart.data.datasets.forEach(function (o) {\r\n\t\t\t\r\n\t\t\to.data = data[ o.label.toLowerCase() ];\r\n\t\t});\r\n\t\tg.chart.update();\r\n\t}\r\n\r\n\tfunction createChart() {\r\n\t\tlet ctx = $(\"#myChart\");  // #f3e3e0\r\n\t\t\r\n\t\tlet options = {\r\n\t\t\tlegend: {\r\n\t\t\t\tdisplay: true,\r\n\t\t\t\tposition: \"right\",\r\n\t\t\t\tlabel: {\r\n\t\t\t\t\tusePointStyle: true\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t};\r\n\t\tlet data = {\r\n\t\t\tlabels: [],\r\n\t\t\tdatasets: [{\r\n\t\t\t\tlabel: \"Urea\",\r\n\t\t\t\tlineTension: 0,\r\n\t\t//\t\tdata: data.urea,\r\n\t\t\t\tfill: false,\r\n\t\t\t\tborderColor: \"blue\"\r\n\t\t\t}, {\r\n\t\t\t\tlabel: \"Prile\",\r\n\t\t\t\tlineTension: 0,\r\n\t\t//\t\tdata: data.prile,\r\n\t\t\t\tfill: false,\r\n\t\t\t\tborderColor: \"green\"\r\n\t\t\t}, {\r\n\t\t\t\tlabel: \"Amonia\",\r\n\t\t\t\tlineTension: 0,\r\n\t\t//\t\tdata: data.amonia,\r\n\t\t\t\tfill: false,\r\n\t\t\t\tborderColor: \"red\"\r\n\t\t\t}, {\r\n\t\t\t\tlabel: \"Melamin\",\r\n\t\t\t\tlineTension: 0,\r\n\t\t//\t\tdata: data.melamin,\r\n\t\t\t\tfill: false,\r\n\t\t\t\tborderColor: \"orange\"\r\n\t\t\t}]\r\n\t\t};\r\n\t\tg.chart = new Chart(ctx, {\r\n\t\t\ttype: \"line\",\r\n\t\t\tdata: data,\r\n\t\t\toptions: options\r\n\t\t});\r\n\t}\r\n\tfunction init() {\r\n\t\tajax();\r\n\t\tcreateChart();\r\n\t}\r\n\t\r\n\tinst.init = init;\r\n\t\r\n\twindow.chart = g;\r\n\treturn inst;\r\n});\r\n\r\n\r\n/*\r\n[{\r\n\tlabel: \"Urea\",\r\n\tfill: false,\r\n\tlineTension: 0,\r\n\tbackgroundColor: \"rgba(75, 192, 192, 0.4)\",\r\n\tborderColor: \"rgba(75,192,192,1)\",\r\n\tborderCapStyle: \"square\", // butt round square\r\n\tborderDash: [],\r\n\tborderDashOffset: 0.0,\r\n\tborderJoinStyle: \"miter\",\r\n\tpointBorderColor: \"rgba(75,192,192,1)\",\r\n\tpointBackgroundColor: \"#fff\",\r\n\tpointBorderWidth: 5,\r\n\tpointHoverRadius: 5,\r\n\tpointHoverBackgroundColor: \"rgba(75, 192, 192, 1)\",\r\n\tpointHoverBorderColor: \"rgba(220, 220, 220, 1)\",\r\n\tpointHoverBorderWidth: 2,\r\n\tpointRadius: 1,\r\n\tpointHitRadius: 10,\r\n\tdata: [65, 59, 80, 81, 56, 55, 40],\r\n\tspanGaps: false,\r\n}, {\r\n\tlabel: \"Prile\",\r\n\tlineTension: 0,\r\n\tdata: [10, 20, 30, 40, 50, 60, 70],\r\n\tfill: false,\r\n\tborderColor: \"green\"\r\n}, {\r\n\tlabel: \"Amonia\",\r\n\tlineTension: 0,\r\n\tdata: [80, 10, 60, 50, 40, 25, 60],\r\n\tfill: false,\r\n\tborderColor: \"red\"\r\n}, {\r\n\tlabel: \"Melamin\",\r\n\tlineTension: 0,\r\n\tdata: [20, 40, 12, 70, 65, 72, 12, 34, 56],\r\n\tfill: false,\r\n\tborderColor: \"orange\"\r\n}]\r\n*/"]}