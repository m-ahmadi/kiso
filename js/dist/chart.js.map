{"version":3,"sources":["../src/chart.js"],"names":["define","inst","AJAX_URL","UREA","PRILE","AMONIA","MELAMIN","SENSORS","join","g","labels","months","chart","chartData","ajax","callback","d","t","Date","num_rows","timestamp_start","setDate","getDate","timestamp_end","now","table_name","sensors","$","url","type","dataType","data","beforeSend","done","handleChartData","fail","list","rowList","getLabels","forEach","o","sensorId","console","log","createChart","labelArr","timestamp","date","push","getMonth","ctx","datasets","label","lineTension","fill","borderColor","options","legend","display","position","usePointStyle","Chart","init","window"],"mappings":";;AAAAA,OAAO,EAAP,EAAW,YAAY;AACtB,KAAIC,OAAO,EAAX;;AAEA,KAAMC,WAAW,kCAAjB;AACA,KAAMC,OAAO,EAAb;AACA,KAAMC,QAAQ,EAAd;AACA,KAAMC,SAAS,EAAf;AACA,KAAMC,UAAU,EAAhB;AACA,KAAMC,UAAU,CAAC,EAAD,EAAK,EAAL,EAAS,EAAT,EAAa,EAAb,EAAiBC,IAAjB,CAAsB,GAAtB,CAAhB;;AAEA,KAAIC,IAAI;AACPC,UAAQ,EADD;AAEPC,UAAQ,CAAC,SAAD,EAAY,UAAZ,EAAwB,OAAxB,EAAiC,OAAjC,EAA0C,KAA1C,EAAiD,MAAjD,EAAyD,MAAzD,EAAiE,QAAjE,EAA2E,WAA3E,EAAwF,SAAxF,EAAmG,UAAnG,EAA+G,UAA/G,CAFD;AAGPC,SAAO,EAHA;AAIPC,aAAW;;AAEX;AANO,EAAR;;AASA,UAASC,IAAT,CAAcC,QAAd,EAAwB;AACvB,MAAIC,IAAI,EAAR;AACA,MAAIC,IAAI,IAAIC,IAAJ,EAAR;;AAEAF,IAAEG,QAAF,GAAa,CAAb;AACAH,IAAEI,eAAF,GAAoBH,EAAEI,OAAF,CAAWJ,EAAEK,OAAF,KAAc,CAAzB,CAApB;AACAN,IAAEO,aAAF,GAAkBL,KAAKM,GAAL,EAAlB;AACAR,IAAES,UAAF,GAAe,cAAf;AACAT,IAAEU,OAAF,GAAYnB,OAAZ;;AAEAoB,IAAEb,IAAF,CAAO;AACNc,QAAK1B,QADC;AAEN2B,SAAM,KAFA;AAGNC,aAAU,MAHJ;AAINC,SAAMf,CAJA;AAKNgB,eAAY,sBAAY,CAAE;AALpB,GAAP,EAOCC,IAPD,CAOOC,eAPP,EAQCC,IARD;AASA;AACD,UAASD,eAAT,CAAyBlB,CAAzB,EAA4B;AAC3B,MAAIoB,OAAOpB,EAAEqB,OAAb;AACA,MAAIxB,YAAY,EAAhB;;AAEAA,YAAUH,MAAV,GAAmB4B,UAAUF,IAAV,CAAnB;;AAEAA,OAAKG,OAAL,CAAa,UAAUC,CAAV,EAAa;;AAEzB,OAAIA,EAAEC,QAAF,KAAetC,IAAnB,EAAyB;AACxBuC,YAAQC,GAAR,CAAYH,CAAZ;AACA,IAFD,MAEO,IAAIA,EAAEC,QAAF,KAAerC,KAAnB,EAA0B,CAEhC,CAFM,MAEA,IAAIoC,EAAEC,QAAF,KAAepC,MAAnB,EAA2B,CAEjC,CAFM,MAEA,IAAImC,EAAEC,QAAF,KAAenC,OAAnB,EAA4B,CAElC;AACD,GAXD;;AAcAsC;AACA;AACD,UAASN,SAAT,CAAmBF,IAAnB,EAAyB;AACxB,MAAIS,WAAW,EAAf;;AAEAT,OAAKG,OAAL,CAAa,UAAUC,CAAV,EAAa;AACzB,OAAIA,EAAEC,QAAF,KAAetC,IAAnB,EAAyB;AACxB,QAAI2C,YAAYN,EAAEM,SAAlB;AACA,QAAIC,OAAO,IAAI7B,IAAJ,CAAS4B,SAAT,CAAX;;AAEAD,aAASG,IAAT,CAAevC,EAAEE,MAAF,CAAUoC,KAAKE,QAAL,EAAV,CAAf;AACA;AACD,GAPD;;AASA,SAAOJ,QAAP;AACA;AACD,UAASD,WAAT,CAAqB/B,SAArB,EAAgC;AAC/B,MAAIqC,MAAMvB,EAAE,UAAF,CAAV,CAD+B,CACL;;AAE1B,MAAII,OAAO;AACVrB,WAAQD,EAAEC,MADA;AAEVyC,aAAU,CAAC;AACVC,WAAO,MADG;AAEVC,iBAAa,CAFH;AAGZ;AACEC,UAAM,KAJI;AAKVC,iBAAa;AALH,IAAD,EAMP;AACFH,WAAO,OADL;AAEFC,iBAAa,CAFX;AAGJ;AACEC,UAAM,KAJJ;AAKFC,iBAAa;AALX,IANO,EAYP;AACFH,WAAO,QADL;AAEFC,iBAAa,CAFX;AAGJ;AACEC,UAAM,KAJJ;AAKFC,iBAAa;AALX,IAZO,EAkBP;AACFH,WAAO,SADL;AAEFC,iBAAa,CAFX;AAGJ;AACEC,UAAM,KAJJ;AAKFC,iBAAa;AALX,IAlBO;AAFA,GAAX;AA4BA,MAAIC,UAAU;AACbC,WAAQ;AACPC,aAAS,IADF;AAEPC,cAAU,OAFH;AAGPP,WAAO;AACNQ,oBAAe;AADT;AAHA;AADK,GAAd;AASAnD,IAAEG,KAAF,GAAU,IAAIiD,KAAJ,CAAUX,GAAV,EAAe;AACxBrB,SAAM,MADkB;AAExBE,SAAMlB,SAFkB;AAGxB2C,YAASA;AAHe,GAAf,CAAV;AAKA;AACD,UAASM,IAAT,GAAgB;AACfhD;AACA;;AAEDb,MAAK6D,IAAL,GAAYA,IAAZ;;AAEAC,QAAOnD,KAAP,GAAeH,CAAf;AACA,QAAOR,IAAP;AACA,CAjID;;AAoIA","file":"chart.js","sourcesContent":["define([], function () {\r\n\tlet inst = {};\r\n\t\r\n\tconst AJAX_URL = \"http://127.0.0.1:1081/khp/report\";\r\n\tconst UREA = 12;\r\n\tconst PRILE = 13;\r\n\tconst AMONIA = 14;\r\n\tconst MELAMIN = 15;\r\n\tconst SENSORS = [12, 13, 14, 15].join(\",\");\r\n\t\r\n\tlet g = {\r\n\t\tlabels: [],\r\n\t\tmonths: [\"January\", \"February\", \"March\", \"April\", \"May\", \"June\", \"July\", \"August\", \"September\", \"October\", \"November\", \"December\"],\r\n\t\tchart: {},\r\n\t\tchartData: {}\r\n\t\t\r\n\t\t// \"rgba(75, 192, 192, 0.4)\"\r\n\t};\r\n\t\r\n\tfunction ajax(callback) {\r\n\t\tlet d = {};\r\n\t\tlet t = new Date();\r\n\t\t\r\n\t\td.num_rows = 7;\r\n\t\td.timestamp_start = t.setDate( t.getDate() - 7 ) ;\r\n\t\td.timestamp_end = Date.now();\r\n\t\td.table_name = \"report_1_day\";\r\n\t\td.sensors = SENSORS;\r\n\t\t\r\n\t\t$.ajax({\r\n\t\t\turl: AJAX_URL,\r\n\t\t\ttype: \"GET\",\r\n\t\t\tdataType: \"json\",\r\n\t\t\tdata: d,\r\n\t\t\tbeforeSend: function () {}\r\n\t\t})\r\n\t\t.done( handleChartData )\r\n\t\t.fail(  );\r\n\t}\r\n\tfunction handleChartData(d) {\r\n\t\tlet list = d.rowList;\r\n\t\tlet chartData = {};\r\n\t\t\r\n\t\tchartData.labels = getLabels(list);\r\n\t\t\r\n\t\tlist.forEach(function (o) {\r\n\t\t\t\r\n\t\t\tif (o.sensorId === UREA) {\r\n\t\t\t\tconsole.log(o);\r\n\t\t\t} else if (o.sensorId === PRILE) {\r\n\t\t\t\r\n\t\t\t} else if (o.sensorId === AMONIA) {\r\n\t\t\t\r\n\t\t\t} else if (o.sensorId === MELAMIN) {\r\n\t\t\t\r\n\t\t\t}\r\n\t\t});\r\n\t\t\r\n\t\t\r\n\t\tcreateChart();\r\n\t}\r\n\tfunction getLabels(list) {\r\n\t\tvar labelArr = [];\r\n\t\t\r\n\t\tlist.forEach(function (o) {\r\n\t\t\tif (o.sensorId === UREA) {\r\n\t\t\t\tlet timestamp = o.timestamp;\r\n\t\t\t\tlet date = new Date(timestamp);\r\n\t\t\t\t\r\n\t\t\t\tlabelArr.push( g.months[ date.getMonth() ] );\r\n\t\t\t} \r\n\t\t});\r\n\t\t\r\n\t\treturn labelArr;\r\n\t}\r\n\tfunction createChart(chartData) {\r\n\t\tlet ctx = $(\"#myChart\");  // #f3e3e0\r\n\t\t\r\n\t\tlet data = {\r\n\t\t\tlabels: g.labels,\r\n\t\t\tdatasets: [{\r\n\t\t\t\tlabel: \"Urea\",\r\n\t\t\t\tlineTension: 0,\r\n\t\t//\t\tdata: [65, 59, 80, 81, 56, 55, 40],\r\n\t\t\t\tfill: false,\r\n\t\t\t\tborderColor: \"blue\"\r\n\t\t\t}, {\r\n\t\t\t\tlabel: \"Prile\",\r\n\t\t\t\tlineTension: 0,\r\n\t\t//\t\tdata: [10, 20, 30, 40, 50, 60, 70],\r\n\t\t\t\tfill: false,\r\n\t\t\t\tborderColor: \"green\"\r\n\t\t\t}, {\r\n\t\t\t\tlabel: \"Amonia\",\r\n\t\t\t\tlineTension: 0,\r\n\t\t//\t\tdata: [80, 10, 60, 50, 40, 25, 60],\r\n\t\t\t\tfill: false,\r\n\t\t\t\tborderColor: \"red\"\r\n\t\t\t}, {\r\n\t\t\t\tlabel: \"Melamin\",\r\n\t\t\t\tlineTension: 0,\r\n\t\t//\t\tdata: [20, 40, 12, 70, 65, 72, 12, 34, 56],\r\n\t\t\t\tfill: false,\r\n\t\t\t\tborderColor: \"orange\"\r\n\t\t\t}]\r\n\t\t};\r\n\t\tlet options = {\r\n\t\t\tlegend: {\r\n\t\t\t\tdisplay: true,\r\n\t\t\t\tposition: \"right\",\r\n\t\t\t\tlabel: {\r\n\t\t\t\t\tusePointStyle: true\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t};\r\n\t\tg.chart = new Chart(ctx, {\r\n\t\t\ttype: \"line\",\r\n\t\t\tdata: chartData,\r\n\t\t\toptions: options\r\n\t\t});\r\n\t}\r\n\tfunction init() {\r\n\t\tajax();\r\n\t}\r\n\t\r\n\tinst.init = init;\r\n\t\r\n\twindow.chart = g;\r\n\treturn inst;\r\n});\r\n\r\n\r\n/*\r\n[{\r\n\tlabel: \"Urea\",\r\n\tfill: false,\r\n\tlineTension: 0,\r\n\tbackgroundColor: \"rgba(75, 192, 192, 0.4)\",\r\n\tborderColor: \"rgba(75,192,192,1)\",\r\n\tborderCapStyle: \"square\", // butt round square\r\n\tborderDash: [],\r\n\tborderDashOffset: 0.0,\r\n\tborderJoinStyle: \"miter\",\r\n\tpointBorderColor: \"rgba(75,192,192,1)\",\r\n\tpointBackgroundColor: \"#fff\",\r\n\tpointBorderWidth: 5,\r\n\tpointHoverRadius: 5,\r\n\tpointHoverBackgroundColor: \"rgba(75, 192, 192, 1)\",\r\n\tpointHoverBorderColor: \"rgba(220, 220, 220, 1)\",\r\n\tpointHoverBorderWidth: 2,\r\n\tpointRadius: 1,\r\n\tpointHitRadius: 10,\r\n\tdata: [65, 59, 80, 81, 56, 55, 40],\r\n\tspanGaps: false,\r\n}, {\r\n\tlabel: \"Prile\",\r\n\tlineTension: 0,\r\n\tdata: [10, 20, 30, 40, 50, 60, 70],\r\n\tfill: false,\r\n\tborderColor: \"green\"\r\n}, {\r\n\tlabel: \"Amonia\",\r\n\tlineTension: 0,\r\n\tdata: [80, 10, 60, 50, 40, 25, 60],\r\n\tfill: false,\r\n\tborderColor: \"red\"\r\n}, {\r\n\tlabel: \"Melamin\",\r\n\tlineTension: 0,\r\n\tdata: [20, 40, 12, 70, 65, 72, 12, 34, 56],\r\n\tfill: false,\r\n\tborderColor: \"orange\"\r\n}]\r\n*/"]}